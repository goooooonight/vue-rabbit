import{E as Y,c as Z}from"./base-Bes0XUun.js";import{E as h,a as ee}from"./breadcrumb-item-BGaU_0zQ.js";import{a as te,E as le}from"./table-column-zcxN6u7C.js";import"./checkbox-B8oi5Mlv.js";/* empty css                */import"./popper-D0fPJ8qx.js";import"./scrollbar-Deottvjw.js";import"./tag-BDl_GAG7.js";import{E as S,_ as D}from"./OrderCard-CSeFDnGM.js";import{E as N}from"./button-ByJsP9uv.js";import{E as se}from"./link-B8FVjYx5.js";import{i as T,E as U}from"./request-FXAcKJdj.js";/* empty css                   */import{r as g,A as M,i as oe,_ as q,c as j,o as E,a as e,f as m,t as x,q as ae,m as X,w as s,d as t,g as o,a5 as G,k as z,l as L,x as de,F as re,j as ne,p as ie,e as ue,u as me}from"./index-DU_P6jZu.js";import{g as pe,c as ce}from"./order-E16ay68r.js";import{E as fe,a as _e}from"./form-item-CR69_ETu.js";import{E as ve}from"./select-Bz5GldId.js";import"./input-BHo3TFaK.js";import{E as xe}from"./index-BbAllY5l.js";import{u as be}from"./useCart-DMzuQVBQ.js";import"./aria-CnJd5Vss.js";import"./error-Cq9Fpw4b.js";import"./isEqual-Bfv98oY_.js";import"./index-fOI-oh1j.js";import"./_initCloneObject-Czt_Nu0w.js";import"./isPlainObject-DPoAC1FZ.js";import"./debounce-BUz-fiHp.js";import"./index-Cy4a31WU.js";import"./use-form-common-props-BOay2t_u.js";import"./index-D26JKrGB.js";import"./constants-Dnj8X3EN.js";import"./event-BB_Ol6Sd.js";import"./index-BWDAezSb.js";import"./index-e-8dcJ2f.js";import"./aria-BmU_cfaq.js";import"./index-Vkpvc9Dk.js";import"./vnode-DLkXDgL1.js";import"./scroll-aQCI3ZGR.js";import"./index-r5W6hzzQ.js";import"./_baseClone-CsHVYERe.js";import"./strings-CYJXMOCd.js";import"./cart-BGMqSPHr.js";const ge=r=>T.post("/member/address",r),ye=()=>T.get("/member/address"),Ae=(r,n)=>T.put(`/member/address/${r}`,n),we=r=>T.delete(`/member/address/${r}`),ke=()=>{const r=g(""),n=g([]),a=async()=>{const{data:{result:c}}=await ye();n.value=c,c.length&&(r.value=c[0].id)};M(()=>a());const p=c=>!c||!n.value.length?n.value[0]:n.value.find(A=>A.id===c)||n.value[0],_=g(),i=()=>{_.value.openDialog()},w=c=>{_.value.openDialog(c)},v=g(!1),b=g("");return oe(v,()=>{v.value&&(b.value=r.value)}),{activeAddr:r,userAddresses:n,getAddress:a,dialogRef:_,openAdd:i,openEdit:w,switchVisible:v,activeAddrDialog:b,confirmSwitch:()=>{r.value=b.value,v.value=!1},getAddrById:p,deleteAddress:async c=>{const{data:{msg:A}}=await we(c);await a(),U.success(A)}}},Ce=()=>{const r=g([]),n=g({}),a=g(!0),p=async()=>{a.value=!0;const{data:{result:_}}=await pe();r.value=_.goods,n.value=_.summary,a.value=!1};return M(()=>{p()}),{goods:r,summary:n,isLoading:a}},Ve={class:"flex flex-col gap-[10px]"},Ee={__name:"AddressUl",props:{addr:Object},setup(r){return(n,a)=>(E(),j("ul",Ve,[e("li",null,[a[0]||(a[0]=e("span",null,[m("收"),e("i",{class:"w-2 inline-block"}),m("货"),e("i",{class:"w-2 inline-block"}),m("人：")],-1)),m(x(r.addr.receiver),1)]),e("li",null,[a[1]||(a[1]=e("span",null,"联系方式：",-1)),m(x(r.addr.contact),1)]),e("li",null,[a[2]||(a[2]=e("span",null,"收货地址：",-1)),m(x(r.addr.fullLocation),1)])]))}},R=q(Ee,[["__scopeId","data-v-bc397b79"]]),Ie=()=>{const r=g(!1),n={receiver:"",contact:"",provinceCode:"210000",cityCode:"210200",countyCode:"210202",address:"",postalCode:"",addressTags:"",isDefault:"1",fullLocation:"阿巴省 阿巴市 阿巴区"},a=g({...n});return{formVisible:r,defaultForm:n,addrForm:a,addAddress:async()=>{const{data:{msg:i}}=await ge(a.value);U.success(i)},editAddress:async i=>{const{data:{msg:w}}=await Ae(i,a.value);U.success(w)}}},$e={class:"flex justify-center"},Fe={__name:"AddressFormDialog",emits:["update-address"],setup(r,{expose:n,emit:a}){const{formVisible:p,defaultForm:_,addrForm:i,addAddress:w,editAddress:v}=Ie(),b=g();n({openDialog:k=>{b.value=k,k?i.value={...k}:i.value={..._},p.value=!0}});const $=ae(()=>b.value?"修改地址":"添加地址"),c=a,A=()=>{c("update-address")},I=async()=>{b.value?await v(b.value.id):await w(),p.value=!1,A()};return(k,u)=>{const C=xe,y=_e,l=ve,P=N,V=fe,O=S;return E(),X(O,{modelValue:o(p),"onUpdate:modelValue":u[6]||(u[6]=f=>G(p)?p.value=f:null),title:$.value,width:"780"},{default:s(()=>[e("div",$e,[t(V,{model:o(i),"label-width":"100",size:"large",class:"w-[500px]"},{default:s(()=>[t(y,{label:"收货人:"},{default:s(()=>[t(C,{modelValue:o(i).receiver,"onUpdate:modelValue":u[0]||(u[0]=f=>o(i).receiver=f),placeholder:"请输入收货人"},null,8,["modelValue"])]),_:1}),t(y,{label:"手机号:"},{default:s(()=>[t(C,{modelValue:o(i).contact,"onUpdate:modelValue":u[1]||(u[1]=f=>o(i).contact=f),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),t(y,{label:"地区:"},{default:s(()=>[t(l,{placeholder:"请选择所在地区"})]),_:1}),t(y,{label:"详细地址:"},{default:s(()=>[t(C,{modelValue:o(i).address,"onUpdate:modelValue":u[2]||(u[2]=f=>o(i).address=f),placeholder:"请输入详细地址"},null,8,["modelValue"])]),_:1}),t(y,{label:"邮政编码:"},{default:s(()=>[t(C,{modelValue:o(i).postalCode,"onUpdate:modelValue":u[3]||(u[3]=f=>o(i).postalCode=f),placeholder:"请输入邮政编码"},null,8,["modelValue"])]),_:1}),t(y,{label:"地址标签:"},{default:s(()=>[t(C,{modelValue:o(i).addressTags,"onUpdate:modelValue":u[4]||(u[4]=f=>o(i).addressTags=f),placeholder:"请输入地址标签，逗号分隔"},null,8,["modelValue"])]),_:1}),t(y,{"label-width":"78"},{default:s(()=>[t(P,{type:"info",onClick:u[5]||(u[5]=f=>p.value=!1),class:"commit-btn"},{default:s(()=>u[7]||(u[7]=[m("取消")])),_:1,__:[7]}),t(P,{type:"primary",onClick:I,class:"commit-btn"},{default:s(()=>u[8]||(u[8]=[m(" 确认 ")])),_:1,__:[8]})]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue","title"])}}},De={class:"bg-white"},je={class:"px-[10px] py-[15px] border border-[#f5f5f5] flex"},Pe={class:"flex flex-1"},Ue={class:"w-[420px] px-[20px] ml-auto flex justify-center items-center"},Te={class:"h-[400px] px-[20px] pt-[20px] overflow-auto"},Be=["onClick"],Oe={class:"w-[50px] ml-auto grid place-content-center opacity-0 group-hover:opacity-100 transition-all duration-500"},ze={class:"flex justify-center gap-[10px]"},Le={alt:"",class:"w-[100px] h-[100px] mr-[10px] rounded-[2px]"},Re={class:"flex-1 text-left min-w-0"},Se={class:"text-[#999] truncate"},Ne={class:"price text-[20px]"},Me={class:"p-[60px] flex justify-end"},qe={__name:"OrderPanel",setup(r){const{activeAddr:n,userAddresses:a,getAddress:p,dialogRef:_,openAdd:i,openEdit:w,switchVisible:v,activeAddrDialog:b,confirmSwitch:B,getAddrById:$,deleteAddress:c}=ke(),{goods:A,summary:I,isLoading:k}=Ce(),u=me(),C=async()=>{const{data:{result:y}}=await ce({deliveryTimeType:1,payType:1,payChannel:1,buyerMessage:"",goods:A.value.map(l=>({skuId:l.skuId,count:l.count})),addressId:n.value});U.success("提交订单成功"),be().cartStore.removeSelectedCart(),u.push(`/pay?orderId=${y.id}`)};return(y,l)=>{const P=se,V=N,O=Y,f=S,H=ue("RouterLink"),F=le,J=te,K=L("img-lazy"),Q=L("load");return z((E(),j("div",De,[!o(k)&&o(a).length>0?(E(),X(D,{key:0,title:"收货地址"},{default:s(()=>[e("div",je,[e("div",Pe,[t(R,{addr:o($)(o(n))},null,8,["addr"]),t(P,{type:"primary",underline:"never",class:"w-[160px] px-[20px] ml-auto border-r border-r-[#f5f5f5]",onClick:l[0]||(l[0]=d=>o(w)(o($)(o(n))))},{default:s(()=>l[4]||(l[4]=[m("修改地址")])),_:1,__:[4]})]),e("div",Ue,[t(V,{type:"primary",size:"large",plain:"",class:"custom-button",onClick:l[1]||(l[1]=d=>v.value=!0)},{default:s(()=>l[5]||(l[5]=[m("切换地址")])),_:1,__:[5]}),t(V,{type:"primary",size:"large",plain:"",class:"custom-button",onClick:o(i)},{default:s(()=>l[6]||(l[6]=[m("添加地址")])),_:1,__:[6]},8,["onClick"])])])]),_:1})):de("",!0),t(Fe,{ref_key:"dialogRef",ref:_,onUpdateAddress:o(p)},null,8,["onUpdateAddress"]),t(f,{modelValue:o(v),"onUpdate:modelValue":l[3]||(l[3]=d=>G(v)?v.value=d:null),title:"切换收货地址",width:"600"},{footer:s(()=>[e("div",ze,[t(V,{type:"info",onClick:l[2]||(l[2]=d=>v.value=!1),class:"commit-btn"},{default:s(()=>l[7]||(l[7]=[m("取消")])),_:1,__:[7]}),t(V,{type:"primary",onClick:o(B),class:"commit-btn"},{default:s(()=>l[8]||(l[8]=[m(" 确认 ")])),_:1,__:[8]},8,["onClick"])])]),default:s(()=>[e("div",Te,[(E(!0),j(re,null,ne(o(a),d=>(E(),j("div",{class:ie(["my-box p-[15px] mb-[10px] rounded-[3px] border border-[#ededed] cursor-pointer group flex",{"my-active-box":o(b)===d.id}]),key:d.id,onClick:W=>b.value=d.id},[t(R,{addr:d},null,8,["addr"]),e("div",Oe,[t(O,{size:"23px",color:"#666",onClick:W=>o(c)(d.id),class:"cursor-pointer"},{default:s(()=>[t(o(Z))]),_:2},1032,["onClick"])])],10,Be))),128))])]),_:1},8,["modelValue"]),t(D,{title:"商品信息"},{default:s(()=>[t(J,{data:o(A),"row-key":"skuId"},{default:s(()=>[t(F,{label:"商品信息",width:"520",align:"center"},{default:s(({row:d})=>[e("div",null,[t(H,{to:`/goods/${d.id}`,class:"flex items-center"},{default:s(()=>[z(e("img",Le,null,512),[[K,d.picture]]),e("div",Re,[e("p",null,x(d.name),1),e("p",Se,x(d.attrsText),1)])]),_:2},1032,["to"])])]),_:1}),t(F,{label:"单价",width:"170",align:"center"},{default:s(({row:d})=>[m(" ￥"+x(d.price),1)]),_:1}),t(F,{prop:"count",label:"数量",width:"170",align:"center"}),t(F,{prop:"name",label:"小计",width:"170",align:"center"},{default:s(({row:d})=>[e("span",null," ￥"+x((d.price*d.count).toFixed(2)),1)]),_:1}),t(F,{prop:"name",label:"实付",width:"170",align:"center"},{default:s(({row:d})=>[e("span",null," ￥"+x((d.price*d.count).toFixed(2)),1)]),_:1})]),_:1},8,["data"])]),_:1}),t(D,{title:"配送时间"},{default:s(()=>l[9]||(l[9]=[e("div",{class:"flex gap-[25px]"},[e("a",{href:"javascript:;",class:"my-btn my-active-btn"},"不限送货时间：周一至周日"),e("a",{href:"javascript:;",class:"my-btn"},"工作日送货：周一至周五"),e("a",{href:"javascript:;",class:"my-btn"},"双休日、假日送货：周六至周日")],-1)])),_:1,__:[9]}),t(D,{title:"支付方式"},{default:s(()=>l[10]||(l[10]=[e("div",{class:"flex gap-[25px]"},[e("a",{href:"javascript:;",class:"my-btn my-active-btn"},"在线支付"),e("a",{href:"javascript:;",class:"my-btn"},"货到付款"),e("p",{class:"leading-[50px] text-[#999]"},"货到付款需5元手续费")],-1)])),_:1,__:[10]}),t(D,{title:"金额明细",class:"border-b border-b-[#f5f5f5]"},{header:s(()=>l[11]||(l[11]=[e("h2",{class:"text-[16px] font-[400]"},"金额明细",-1)])),default:s(()=>[e("div",null,[e("dl",null,[l[12]||(l[12]=e("dt",null,"商品件数:",-1)),e("dd",null,x(o(I).goodsCount)+"件",1)]),e("dl",null,[l[13]||(l[13]=e("dt",null,"商品总价:",-1)),e("dd",null,"￥"+x(o(I).totalPrice),1)]),e("dl",null,[l[14]||(l[14]=e("dt",null,[m("运"),e("i",{class:"w-8 inline-block"}),m("费:")],-1)),e("dd",null,"￥"+x(o(I).postFee),1)]),e("dl",null,[l[15]||(l[15]=e("dt",null,"应付总额:",-1)),e("dd",Ne,"￥"+x(o(I).totalPayPrice),1)])])]),_:1}),e("div",Me,[t(V,{type:"primary",size:"large",class:"commit-btn",onClick:C},{default:s(()=>l[16]||(l[16]=[m("提交订单")])),_:1,__:[16]})])])),[[Q,o(k)]])}}},Xe=q(qe,[["__scopeId","data-v-d2300971"]]),Ge={class:"xtx-container"},Tt={__name:"XtxOrder",setup(r){return(n,a)=>{const p=ee,_=h;return E(),j("div",Ge,[t(_,{separator:">",class:"mx-2 my-10"},{default:s(()=>[t(p,{to:"/"},{default:s(()=>a[0]||(a[0]=[m("首页")])),_:1,__:[0]}),t(p,{to:"/cart"},{default:s(()=>a[1]||(a[1]=[m(" 购物车 ")])),_:1,__:[1]}),t(p,null,{default:s(()=>a[2]||(a[2]=[m(" 填写订单 ")])),_:1,__:[2]})]),_:1}),t(Xe)])}}};export{Tt as default};
